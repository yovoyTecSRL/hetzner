<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ORBIX Ae.N.K.I - Ultimate Defense System</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto:wght@300;400;500&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-gold: #ffd700;
            --primary-blue: #0066cc;
            --dark-bg: #0a0a0a;
            --panel-bg: rgba(26, 26, 46, 0.9);
            --glass-bg: rgba(255, 255, 255, 0.1);
            --neon-glow: 0 0 20px var(--primary-gold);
            --text-light: #ffffff;
            --text-muted: #cccccc;
            --success: #00ff88;
            --warning: #ffaa00;
            --danger: #ff3366;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: radial-gradient(ellipse at center, #1a1a2e 0%, #16213e 35%, #0f3460 100%);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            color: var(--text-light);
        }

        /* Animated Background */
        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            background: var(--primary-gold);
            border-radius: 50%;
            opacity: 0.6;
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        .neural-network {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="%23ffd700" stroke-width="0.5" opacity="0.3"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            animation: pulse 4s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.6; }
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 2;
        }

        /* Header Section */
        .header {
            background: linear-gradient(135deg, var(--panel-bg) 0%, rgba(15, 52, 96, 0.9) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid var(--primary-gold);
            border-radius: 25px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: var(--neon-glow), inset 0 0 20px rgba(255, 215, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 215, 0, 0.1), transparent);
            animation: rotate 10s linear infinite;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .header-content {
            position: relative;
            z-index: 2;
        }

        .header h1 {
            font-family: 'Orbitron', monospace;
            font-size: 4em;
            font-weight: 900;
            margin-bottom: 10px;
            text-shadow: 0 0 30px var(--primary-gold);
            background: linear-gradient(45deg, var(--primary-gold), #ffed4a, var(--primary-gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: glow 3s ease-in-out infinite;
        }

        @keyframes glow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        .header .subtitle {
            font-size: 1.5em;
            color: var(--text-muted);
            margin-bottom: 20px;
        }

        .status-banner {
            display: inline-block;
            background: linear-gradient(45deg, var(--success), #00cc66);
            color: white;
            padding: 12px 30px;
            border-radius: 25px;
            font-weight: 500;
            font-size: 1.1em;
            box-shadow: 0 5px 15px rgba(0, 255, 136, 0.3);
            animation: statusPulse 2s ease-in-out infinite;
        }

        @keyframes statusPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Avatar Section */
        .avatar-section {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 40px 0;
            position: relative;
        }

        .avatar-container {
            position: relative;
            width: 300px;
            height: 300px;
        }

        .avatar {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 4px solid var(--primary-gold);
            box-shadow: var(--neon-glow), inset 0 0 20px rgba(255, 215, 0, 0.2);
            animation: breathe 4s ease-in-out infinite;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .avatar:hover {
            transform: scale(1.05);
            box-shadow: 0 0 40px var(--primary-gold), inset 0 0 30px rgba(255, 215, 0, 0.3);
        }

        @keyframes breathe {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .avatar.talking {
            animation: talking 0.3s ease-in-out infinite;
        }

        @keyframes talking {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.08); }
        }

        .avatar.listening {
            animation: listening 1s ease-in-out infinite;
            border-color: var(--primary-blue);
            box-shadow: 0 0 30px var(--primary-blue);
        }

        @keyframes listening {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .avatar.processing {
            animation: processing 0.8s linear infinite;
        }

        @keyframes processing {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .avatar-status {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            padding: 10px 20px;
            border-radius: 20px;
            border: 1px solid var(--primary-gold);
            font-size: 0.9em;
            text-align: center;
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .panel {
            background: var(--glass-bg);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .panel:hover::before {
            left: 100%;
        }

        .panel:hover {
            transform: translateY(-10px);
            box-shadow: 0 25px 50px rgba(255, 215, 0, 0.2);
            border-color: var(--primary-gold);
        }

        .panel h3 {
            font-family: 'Orbitron', monospace;
            color: var(--primary-gold);
            margin-bottom: 20px;
            font-size: 1.8em;
            font-weight: 700;
            text-shadow: 0 0 10px var(--primary-gold);
        }

        /* Chat Interface */
        .chat-container {
            height: 500px;
            display: flex;
            flex-direction: column;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            overflow: hidden;
        }

        .chat-header {
            background: linear-gradient(45deg, var(--primary-gold), #ffed4a);
            color: var(--dark-bg);
            padding: 15px;
            font-weight: 500;
            text-align: center;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--primary-gold) transparent;
        }

        .chat-messages::-webkit-scrollbar {
            width: 8px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: transparent;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: var(--primary-gold);
            border-radius: 4px;
        }

        .message {
            margin: 15px 0;
            padding: 15px;
            border-radius: 15px;
            max-width: 80%;
            position: relative;
            animation: messageAppear 0.3s ease-out;
        }

        @keyframes messageAppear {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .user-message {
            background: linear-gradient(45deg, var(--primary-gold), #ffed4a);
            color: var(--dark-bg);
            margin-left: auto;
            font-weight: 500;
        }

        .ai-message {
            background: var(--glass-bg);
            border: 1px solid rgba(255, 215, 0, 0.3);
            color: var(--text-light);
        }

        .chat-input-container {
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-top: 1px solid rgba(255, 215, 0, 0.3);
        }

        .chat-input {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .chat-input input {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid rgba(255, 215, 0, 0.5);
            border-radius: 25px;
            background: rgba(0, 0, 0, 0.3);
            color: var(--text-light);
            font-size: 1em;
            outline: none;
            transition: all 0.3s ease;
        }

        .chat-input input:focus {
            border-color: var(--primary-gold);
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
        }

        .chat-input input::placeholder {
            color: var(--text-muted);
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            background: linear-gradient(45deg, var(--primary-gold), #ffed4a);
            color: var(--dark-bg);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1em;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 215, 0, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-voice {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
        }

        .btn-voice.active {
            background: linear-gradient(45deg, var(--danger), #ff6b6b);
            animation: recording 1s ease-in-out infinite;
        }

        @keyframes recording {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* Metrics Panel */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: var(--glass-bg);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(255, 215, 0, 0.2);
        }

        .metric-value {
            font-size: 2.5em;
            font-weight: 700;
            color: var(--success);
            margin-bottom: 5px;
            font-family: 'Orbitron', monospace;
        }

        .metric-label {
            color: var(--text-muted);
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .metric-chart {
            height: 40px;
            margin-top: 10px;
            background: linear-gradient(45deg, var(--success), transparent);
            border-radius: 5px;
            position: relative;
            overflow: hidden;
        }

        .metric-chart::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: shimmer 2s linear infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Status Indicators */
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }

        .status-light {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: statusBlink 2s infinite;
        }

        .status-light.online {
            background: var(--success);
            box-shadow: 0 0 10px var(--success);
        }

        .status-light.warning {
            background: var(--warning);
            box-shadow: 0 0 10px var(--warning);
        }

        .status-light.error {
            background: var(--danger);
            box-shadow: 0 0 10px var(--danger);
        }

        @keyframes statusBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Logs Panel */
        .logs-container {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
            padding: 20px;
            height: 400px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .log-entry {
            margin: 8px 0;
            padding: 8px 12px;
            border-left: 3px solid var(--primary-gold);
            background: rgba(255, 215, 0, 0.05);
            border-radius: 0 5px 5px 0;
            animation: logAppear 0.3s ease-out;
        }

        @keyframes logAppear {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .log-entry.info { 
            border-left-color: var(--success); 
            color: var(--success); 
        }
        
        .log-entry.warning { 
            border-left-color: var(--warning); 
            color: var(--warning); 
        }
        
        .log-entry.error { 
            border-left-color: var(--danger); 
            color: var(--danger); 
        }

        .log-timestamp {
            color: var(--text-muted);
            font-size: 0.8em;
        }

        /* Controls Panel */
        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .control-btn {
            padding: 15px 20px;
            border: none;
            border-radius: 12px;
            background: linear-gradient(45deg, var(--glass-bg), rgba(255, 215, 0, 0.1));
            color: var(--text-light);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 215, 0, 0.3);
            font-size: 1em;
        }

        .control-btn:hover {
            background: linear-gradient(45deg, var(--primary-gold), #ffed4a);
            color: var(--dark-bg);
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(255, 215, 0, 0.3);
        }

        .control-btn:active {
            transform: translateY(-1px);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .header h1 {
                font-size: 2.5em;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .avatar-container {
                width: 200px;
                height: 200px;
            }

            .metrics-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Additional Animations */
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide-in {
            animation: slideIn 0.8s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-50px); }
            to { opacity: 1; transform: translateX(0); }
        }
    </style>
</head>
<body>
    <div class="animated-bg">
        <div class="neural-network"></div>
    </div>

    <div class="container">
        <header class="header fade-in">
            <div class="header-content">
                <h1>ORBIX Ae.N.K.I</h1>
                <p class="subtitle">Sistema de Defensa de Inteligencia Artificial Avanzada</p>
                <div class="status-banner">
                    🛡️ SISTEMA OPERATIVO - DEFENSA ACTIVA
                </div>
            </div>
        </header>

        <div class="avatar-section fade-in">
            <div class="avatar-container">
                <img src="https://sistemasorbix.com/assets/img/aenki-avatar.png" alt="Ae.N.K.I Avatar" class="avatar" id="avatar">
                <div class="avatar-status">
                    <div id="avatarStatus">En Línea - Listo para Interactuar</div>
                </div>
            </div>
        </div>

        <div class="dashboard-grid">
            <div class="panel slide-in">
                <h3>🤖 Chat Inteligente</h3>
                <div class="chat-container">
                    <div class="chat-header">
                        Ae.N.K.I - Asistente de Defensa IA
                    </div>
                    <div class="chat-messages" id="chatMessages">
                        <div class="message ai-message">
                            🌟 ¡Hola! Soy Ae.N.K.I, tu asistente de defensa con inteligencia artificial avanzada. 
                            Estoy aquí para proteger, monitorear y asistir en todas las operaciones de seguridad. 
                            ¿En qué puedo ayudarte hoy?
                        </div>
                    </div>
                    <div class="chat-input-container">
                        <div class="chat-input">
                            <input type="text" id="messageInput" placeholder="Escribe tu consulta aquí...">
                            <button class="btn btn-voice" onclick="toggleVoice()" id="voiceBtn">🎤</button>
                            <button class="btn" onclick="sendMessage()">Enviar</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="panel slide-in">
                <h3>📊 Métricas Avanzadas</h3>
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-value" id="cpuUsage">23%</div>
                        <div class="metric-label">CPU</div>
                        <div class="metric-chart"></div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="memoryUsage">45%</div>
                        <div class="metric-label">Memoria</div>
                        <div class="metric-chart"></div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="networkActivity">2.1GB</div>
                        <div class="metric-label">Red</div>
                        <div class="metric-chart"></div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="threats">0</div>
                        <div class="metric-label">Amenazas</div>
                        <div class="metric-chart"></div>
                    </div>
                </div>
                <div class="status-grid">
                    <div class="status-indicator">
                        <div class="status-light online"></div>
                        <span>Sistema Operativo</span>
                    </div>
                    <div class="status-indicator">
                        <div class="status-light online"></div>
                        <span>Defensa Activa</span>
                    </div>
                    <div class="status-indicator">
                        <div class="status-light warning"></div>
                        <span>Modo Aprendizaje</span>
                    </div>
                    <div class="status-indicator">
                        <div class="status-light online"></div>
                        <span>Conexión Estable</span>
                    </div>
                </div>
            </div>

            <div class="panel slide-in">
                <h3>📝 Logs del Sistema</h3>
                <div class="logs-container" id="logContainer">
                    <div class="log-entry info">
                        <span class="log-timestamp">[2025-01-31 14:30:15]</span> 
                        Sistema ORBIX Ae.N.K.I iniciado correctamente
                    </div>
                    <div class="log-entry info">
                        <span class="log-timestamp">[2025-01-31 14:30:16]</span> 
                        Módulos de defensa cargados y operativos
                    </div>
                    <div class="log-entry info">
                        <span class="log-timestamp">[2025-01-31 14:30:17]</span> 
                        Conexión establecida con servidor principal
                    </div>
                    <div class="log-entry info">
                        <span class="log-timestamp">[2025-01-31 14:30:18]</span> 
                        Escaneo de seguridad completado - Sistema limpio
                    </div>
                </div>
            </div>

            <div class="panel slide-in">
                <h3>🎛️ Centro de Control</h3>
                <div class="controls-grid">
                    <button class="control-btn" onclick="runDiagnostic()">
                        🔍 Diagnóstico
                    </button>
                    <button class="control-btn" onclick="updateStatus()">
                        🔄 Actualizar
                    </button>
                    <button class="control-btn" onclick="emergencyMode()">
                        🚨 Emergencia
                    </button>
                    <button class="control-btn" onclick="runSecurityScan()">
                        🛡️ Escaneo
                    </button>
                    <button class="control-btn" onclick="optimizeSystem()">
                        ⚡ Optimizar
                    </button>
                    <button class="control-btn" onclick="generateReport()">
                        📋 Reporte
                    </button>
                </div>
                <div class="status-grid">
                    <div class="status-indicator">
                        <div class="status-light online"></div>
                        <span>Todos los Sistemas</span>
                    </div>
                    <div class="status-indicator">
                        <div class="status-light online"></div>
                        <span>Conectividad</span>
                    </div>
                    <div class="status-indicator">
                        <div class="status-light warning"></div>
                        <span>Monitoreo Activo</span>
                    </div>
                    <div class="status-indicator">
                        <div class="status-light online"></div>
                        <span>Protección Total</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Variables globales
        let isVoiceActive = false;
        let recognition;
        let isSystemActive = true;
        let avatarCurrentState = 'idle';
        let logCounter = 0;

        // Respuestas inteligentes de Ae.N.K.I
        const aiResponses = {
            greetings: [
                "¡Hola! Soy Ae.N.K.I, tu asistente de defensa IA. ¿En qué puedo ayudarte?",
                "Saludos, comandante. Todos los sistemas están operativos y listos.",
                "¡Perfecto! Estoy aquí para proteger y asistir. ¿Cuál es tu consulta?"
            ],
            status: [
                "Todos los sistemas están funcionando de manera óptima.",
                "Estado: Operativo al 100%. Defensas activadas y monitoreando.",
                "Sistema estable. Todas las métricas dentro de parámetros normales."
            ],
            security: [
                "Iniciando escaneo de seguridad avanzado... No se detectaron amenazas.",
                "Protocolos de seguridad activos. Perímetro digital asegurado.",
                "Sistema fortificado. Todas las defensas están en línea."
            ],
            analysis: [
                "Analizando datos... Procesamiento completado. Resultados óptimos.",
                "Ejecutando análisis profundo del sistema... Todo en orden.",
                "Correlación de datos finalizada. Patrones normales detectados."
            ],
            default: [
                "Procesando tu solicitud... Análisis en progreso.",
                "Entendido. Ejecutando protocolo correspondiente.",
                "Comando recibido. Iniciando procedimiento de respuesta."
            ]
        };

        // Inicialización del sistema
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 Iniciando ORBIX Ae.N.K.I Ultimate...');
            initializeSystem();
            initializeVoiceRecognition();
            createAnimatedBackground();
            startSystemMonitoring();
            addLogEntry('Sistema ORBIX Ae.N.K.I Ultimate iniciado correctamente', 'info');
        });

        function initializeSystem() {
            // Configurar avatar
            const avatar = document.getElementById('avatar');
            avatar.addEventListener('click', function() {
                if (avatarCurrentState === 'idle') {
                    setAvatarState('talking');
                    speakResponse("¡Hola! Soy Ae.N.K.I. Todos los sistemas están operativos.");
                }
            });

            // Configurar eventos de entrada
            document.getElementById('messageInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });

            // Inicializar métricas
            updateMetrics();
            setInterval(updateMetrics, 10000); // Actualizar cada 10 segundos
        }

        function createAnimatedBackground() {
            const bg = document.querySelector('.animated-bg');
            
            // Crear partículas flotantes
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.width = Math.random() * 4 + 2 + 'px';
                particle.style.height = particle.style.width;
                particle.style.animationDelay = Math.random() * 6 + 's';
                particle.style.animationDuration = (Math.random() * 4 + 4) + 's';
                bg.appendChild(particle);
            }
        }

        function initializeVoiceRecognition() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                recognition = new SpeechRecognition();
                recognition.continuous = true;
                recognition.interimResults = true;
                recognition.lang = 'es-ES';

                recognition.onstart = function() {
                    setAvatarState('listening');
                    updateAvatarStatus('Escuchando...');
                };

                recognition.onresult = function(event) {
                    let finalTranscript = '';
                    for (let i = event.resultIndex; i < event.results.length; i++) {
                        if (event.results[i].isFinal) {
                            finalTranscript += event.results[i][0].transcript;
                        }
                    }
                    if (finalTranscript.trim()) {
                        document.getElementById('messageInput').value = finalTranscript;
                        processVoiceCommand(finalTranscript);
                    }
                };

                recognition.onerror = function(event) {
                    console.error('Error de reconocimiento de voz:', event.error);
                    addLogEntry('Error en reconocimiento de voz: ' + event.error, 'warning');
                    setAvatarState('idle');
                    updateAvatarStatus('En Línea - Listo para Interactuar');
                };

                recognition.onend = function() {
                    isVoiceActive = false;
                    const voiceBtn = document.getElementById('voiceBtn');
                    voiceBtn.classList.remove('active');
                    voiceBtn.textContent = '🎤';
                    setAvatarState('idle');
                    updateAvatarStatus('En Línea - Listo para Interactuar');
                };
            }
        }

        function toggleVoice() {
            const voiceBtn = document.getElementById('voiceBtn');
            
            if (!isVoiceActive) {
                recognition.start();
                isVoiceActive = true;
                voiceBtn.classList.add('active');
                voiceBtn.textContent = '🔴';
                addLogEntry('Reconocimiento de voz activado', 'info');
            } else {
                recognition.stop();
                isVoiceActive = false;
                voiceBtn.classList.remove('active');
                voiceBtn.textContent = '🎤';
                addLogEntry('Reconocimiento de voz desactivado', 'info');
            }
        }

        function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const message = messageInput.value.trim();
            
            if (message) {
                addMessage(message, 'user');
                messageInput.value = '';
                
                // Procesar mensaje
                setAvatarState('processing');
                updateAvatarStatus('Procesando...');
                
                setTimeout(() => {
                    const response = generateIntelligentResponse(message);
                    addMessage(response, 'ai');
                    speakResponse(response);
                    setAvatarState('talking');
                    updateAvatarStatus('Respondiendo...');
                    
                    setTimeout(() => {
                        setAvatarState('idle');
                        updateAvatarStatus('En Línea - Listo para Interactuar');
                    }, 3000);
                }, 1500);
            }
        }

        function generateIntelligentResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            if (lowerMessage.includes('hola') || lowerMessage.includes('saludos')) {
                return getRandomResponse(aiResponses.greetings);
            } else if (lowerMessage.includes('estado') || lowerMessage.includes('status')) {
                return getRandomResponse(aiResponses.status);
            } else if (lowerMessage.includes('seguridad') || lowerMessage.includes('amenaza')) {
                return getRandomResponse(aiResponses.security);
            } else if (lowerMessage.includes('analizar') || lowerMessage.includes('análisis')) {
                return getRandomResponse(aiResponses.analysis);
            } else if (lowerMessage.includes('diagnóstico') || lowerMessage.includes('diagnostico')) {
                return "Iniciando diagnóstico completo del sistema... ✅ CPU: Óptimo ✅ Memoria: Estable ✅ Red: Activa ✅ Seguridad: Máxima";
            } else if (lowerMessage.includes('ayuda') || lowerMessage.includes('help')) {
                return "Puedo ayudarte con: 🔍 Diagnósticos, 📊 Métricas, 🛡️ Seguridad, 🔧 Optimización, 📋 Reportes. ¿Qué necesitas?";
            } else {
                return getRandomResponse(aiResponses.default);
            }
        }

        function getRandomResponse(responses) {
            return responses[Math.floor(Math.random() * responses.length)];
        }

        function addMessage(message, type) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}-message`;
            messageDiv.textContent = message;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function speakResponse(text) {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel(); // Cancelar cualquier síntesis anterior
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'es-ES';
                utterance.rate = 0.9;
                utterance.pitch = 1.1;
                utterance.volume = 0.8;
                
                utterance.onstart = function() {
                    setAvatarState('talking');
                };
                
                utterance.onend = function() {
                    setAvatarState('idle');
                };
                
                window.speechSynthesis.speak(utterance);
            }
        }

        function setAvatarState(state) {
            const avatar = document.getElementById('avatar');
            avatar.className = `avatar ${state}`;
            avatarCurrentState = state;
        }

        function updateAvatarStatus(status) {
            document.getElementById('avatarStatus').textContent = status;
        }

        function updateMetrics() {
            // Simular métricas realistas
            const cpuUsage = Math.floor(Math.random() * 15 + 20); // 20-35%
            const memoryUsage = Math.floor(Math.random() * 20 + 40); // 40-60%
            const networkActivity = (Math.random() * 1.5 + 1.5).toFixed(1); // 1.5-3.0GB
            const threats = Math.random() < 0.95 ? 0 : Math.floor(Math.random() * 3 + 1); // 95% sin amenazas
            
            document.getElementById('cpuUsage').textContent = cpuUsage + '%';
            document.getElementById('memoryUsage').textContent = memoryUsage + '%';
            document.getElementById('networkActivity').textContent = networkActivity + 'GB';
            document.getElementById('threats').textContent = threats;
            
            // Cambiar colores según valores
            const cpuElement = document.getElementById('cpuUsage');
            cpuElement.style.color = cpuUsage > 80 ? 'var(--danger)' : cpuUsage > 60 ? 'var(--warning)' : 'var(--success)';
            
            const memoryElement = document.getElementById('memoryUsage');
            memoryElement.style.color = memoryUsage > 80 ? 'var(--danger)' : memoryUsage > 60 ? 'var(--warning)' : 'var(--success)';
            
            const threatsElement = document.getElementById('threats');
            threatsElement.style.color = threats > 0 ? 'var(--danger)' : 'var(--success)';
        }

        function addLogEntry(message, type) {
            const logContainer = document.getElementById('logContainer');
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry ${type}`;
            
            const timestamp = new Date().toLocaleString();
            logEntry.innerHTML = `
                <span class="log-timestamp">[${timestamp}]</span> 
                ${message}
            `;
            
            logContainer.appendChild(logEntry);
            logContainer.scrollTop = logContainer.scrollHeight;
            
            // Mantener solo los últimos 50 logs
            const logs = logContainer.querySelectorAll('.log-entry');
            if (logs.length > 50) {
                logs[0].remove();
            }
        }

        function processVoiceCommand(command) {
            const lowerCommand = command.toLowerCase();
            
            if (lowerCommand.includes('diagnóstico') || lowerCommand.includes('diagnostico')) {
                runDiagnostic();
            } else if (lowerCommand.includes('actualizar') || lowerCommand.includes('estado')) {
                updateStatus();
            } else if (lowerCommand.includes('emergencia') || lowerCommand.includes('alerta')) {
                emergencyMode();
            } else if (lowerCommand.includes('escaneo') || lowerCommand.includes('seguridad')) {
                runSecurityScan();
            } else if (lowerCommand.includes('optimizar') || lowerCommand.includes('optimización')) {
                optimizeSystem();
            } else {
                // Procesar como mensaje normal
                addMessage(command, 'user');
                setTimeout(() => {
                    const response = generateIntelligentResponse(command);
                    addMessage(response, 'ai');
                    speakResponse(response);
                }, 1000);
            }
        }

        function startSystemMonitoring() {
            // Actualizar logs automáticamente
            setInterval(() => {
                const randomEvents = [
                    'Monitoreo de red completado - Tráfico normal',
                    'Verificación de integridad del sistema - OK',
                    'Actualización de definiciones de seguridad',
                    'Optimización automática ejecutada',
                    'Backup de configuración realizado',
                    'Análisis de patrones de comportamiento'
                ];
                
                if (Math.random() < 0.3) { // 30% de probabilidad
                    const event = randomEvents[Math.floor(Math.random() * randomEvents.length)];
                    addLogEntry(event, 'info');
                }
            }, 15000); // Cada 15 segundos
        }

        // Funciones de control
        function runDiagnostic() {
            addLogEntry('Iniciando diagnóstico completo del sistema...', 'info');
            setAvatarState('processing');
            updateAvatarStatus('Ejecutando Diagnóstico...');
            
            const diagnosticSteps = [
                'Verificando integridad del sistema...',
                'Analizando rendimiento de CPU...',
                'Evaluando uso de memoria...',
                'Comprobando conectividad de red...',
                'Validando protocolos de seguridad...',
                'Diagnóstico completado - Sistema operativo al 100%'
            ];
            
            diagnosticSteps.forEach((step, index) => {
                setTimeout(() => {
                    addLogEntry(step, index === diagnosticSteps.length - 1 ? 'info' : 'info');
                    if (index === diagnosticSteps.length - 1) {
                        setAvatarState('idle');
                        updateAvatarStatus('Diagnóstico Completado');
                        speakResponse('Diagnóstico completado. Todos los sistemas operativos.');
                    }
                }, (index + 1) * 1000);
            });
        }

        function updateStatus() {
            addLogEntry('Actualizando estado del sistema...', 'info');
            updateMetrics();
            
            setTimeout(() => {
                addLogEntry('Estado del sistema actualizado correctamente', 'info');
                speakResponse('Estado actualizado. Todos los sistemas funcionando correctamente.');
            }, 2000);
        }

        function emergencyMode() {
            addLogEntry('⚠️ MODO EMERGENCIA ACTIVADO ⚠️', 'warning');
            setAvatarState('processing');
            updateAvatarStatus('MODO EMERGENCIA ACTIVO');
            
            setTimeout(() => {
                addLogEntry('Todas las defensas han sido activadas al máximo nivel', 'warning');
                addLogEntry('Monitoreo intensivo en progreso...', 'warning');
                speakResponse('Modo emergencia activado. Todas las defensas al máximo nivel.');
            }, 1500);
        }

        function runSecurityScan() {
            addLogEntry('Iniciando escaneo de seguridad avanzado...', 'info');
            setAvatarState('processing');
            updateAvatarStatus('Escaneando...');
            
            const scanSteps = [
                'Escaneando puertos de red...',
                'Verificando integridad de archivos...',
                'Analizando patrones de tráfico...',
                'Comprobando vulnerabilidades...',
                'Escaneo completado - Sistema seguro'
            ];
            
            scanSteps.forEach((step, index) => {
                setTimeout(() => {
                    addLogEntry(step, 'info');
                    if (index === scanSteps.length - 1) {
                        setAvatarState('idle');
                        updateAvatarStatus('Escaneo Completado');
                        speakResponse('Escaneo de seguridad completado. No se detectaron amenazas.');
                    }
                }, (index + 1) * 1200);
            });
        }

        function optimizeSystem() {
            addLogEntry('Iniciando optimización del sistema...', 'info');
            setAvatarState('processing');
            updateAvatarStatus('Optimizando...');
            
            setTimeout(() => {
                addLogEntry('Optimización completada - Rendimiento mejorado', 'info');
                updateMetrics();
                setAvatarState('idle');
                updateAvatarStatus('Optimización Completada');
                speakResponse('Sistema optimizado. Rendimiento mejorado.');
            }, 3000);
        }

        function generateReport() {
            addLogEntry('Generando reporte del sistema...', 'info');
            setAvatarState('processing');
            updateAvatarStatus('Generando Reporte...');
            
            setTimeout(() => {
                addLogEntry('Reporte generado exitosamente', 'info');
                setAvatarState('idle');
                updateAvatarStatus('Reporte Generado');
                speakResponse('Reporte del sistema generado exitosamente.');
            }, 2500);
        }
    </script>
</body>
</html>
